<div class="container">
  <h1 class="mt-3">Edit Blog</h1>

  <form class="mt-3" [formGroup]="editBlogPostForm" (ngSubmit)="onSubmit()">
    <div class="mb-3">
      <label for="title">Title</label>
      <input type="text" id="title" class="form-control" formControlName="title" />
    </div>
    <div class="mb-3">
      <label for="shortDescription">Short Description</label>
      <input
        type="text"
        id="shortDescription"
        class="form-control"
        formControlName="shortDescription"
      />
    </div>
    <div class="mb-3">
      <div class="d-flex flex-row">
        <div class="col-6 p-2">
          <label for="content">Content</label>
          <textarea
            type="text"
            id="content"
            class="form-control"
            formControlName="content"
          ></textarea>
        </div>
        <div class="col-6 p-2" style="max-height: 350px; overflow-y: scroll">
          <markdown [data]="editBlogPostForm.controls.content.getRawValue()"></markdown>
        </div>
      </div>
    </div>
    <div class="mb-3">
      <label for="urlHandle">URL Handle</label>
      <input type="text" id="urlHandle" class="form-control" formControlName="urlHandle" />
    </div>
    <div class="mb-3">
      <label for="featuredImageUrl">Featured Image URL </label>

      <div class="mt-3">
        <button class="btn btn-info" type="button" (click)="openImageSelector()">
          Select Images
        </button>
      </div>
      @if(editBlogPostForm.controls.featuredImageUrl.getRawValue()) {
      <div class="mb-2">
        <img
          [src]="editBlogPostForm.controls.featuredImageUrl.getRawValue()"
          alt="Featured Image"
          class="img-fluid my-3"
          style="width: 200px"
        />
      </div>
      }
      <input
        type="text"
        id="featuredImageUrl"
        class="form-control"
        formControlName="featuredImageUrl"
      />
    </div>
    <div class="mb-3">
      <label for="publishedDate">Published Date</label>
      <input type="date" id="publishedDate" class="form-control" formControlName="publishedDate" />
    </div>
    <div class="mb-3">
      <label for="author">Author</label>
      <input type="text" id="author" class="form-control" formControlName="author" />
    </div>
    <div class="mb-3">
      <label for="isVisible">Is Visible?</label>
      <div class="form-check">
        <input
          type="checkbox"
          id="isVisible"
          class="form-check-input"
          formControlName="isVisible"
        />
        <label class="form-check-label" for="isVisible">Visible to public</label>
      </div>
    </div>

    <div class="mb-3">
      <label for="categories" class="form-label"> Categories </label>
      <select class="form-control" multiple formControlName="categories">
        @for(category of categoriesResponse(); track category.id) {
        <option [value]="category.id">{{ category.name }}</option>
        }
      </select>
    </div>

    <div class="mb-3 d-flex gap-4">
      <button type="submit" class="btn btn-primary">Edit Blog</button>
      <button type="button" class="btn btn-danger" (click)="onDelete()">Delete Blog</button>
    </div>
  </form>
</div>

<app-image-selector></app-image-selector>
